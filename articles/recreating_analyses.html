<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reproducing the Website Analyses • salem</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Reproducing the Website Analyses">
<meta property="og:description" content="salem">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">salem</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/recreating_analyses.html">Reproducing the Website Analyses</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="recreating_analyses_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="recreating_analyses_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="recreating_analyses_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reproducing the Website Analyses</h1>
            
            <h4 class="date">2020-11-06</h4>
      
      
      <div class="hidden name"><code>recreating_analyses.Rmd</code></div>

    </div>

    
    
<p>The <a href="https://www.tulane.edu/~salem/index.html">Salem Witchcraft Website</a> presents a number of data analyses and explains how to reproduce them using Excel. This vignette will document how to as closely as possible reproduce those analyses using R. In some cases the analyses will be extended in order to illustrate points in the website text that were not easily expressible in Excel.</p>
<p>While the website has seven data sets, the package has only 5. This is because R makes it relatively simple to manipulate the data and also because this organization is more in line with how social scientists would likely create a data set today.</p>
<p>As is always true in R, there are many different ways to do the same thing. If you are using this for teaching purposes you will likely want to use the approach that most closely matches what you are doing in your course and what your goals are for students to work on their own analyses. The focus of this document is on use of <em>ggplot2</em> for graphing and in subsequent iterations will also illustrate use of the base R plotting system. There are some examples that use the tidyverse for analysis and some that use base R. However, even within these major groupings there are many ways to acheive the same goals. We have aimed to present ways to do this that are relatively accessible to people who have not used R extensively.</p>
<p>Many of the analyses presented are graphical and so that will be the focus here. However some preprocessing will also be illustrated.</p>
<p>This version does not yet include spatial analysis, but that is on the roadmap.</p>
<p>For the ggplots this theme is being used in may cases.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="va">salem_theme</span> <span class="op">&lt;-</span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></pre></div>
<div id="accusations-and-executions" class="section level2">
<h2 class="hasAnchor">
<a href="#accusations-and-executions" class="anchor"></a>Accusations and Executions</h2>
<p>The website includes displays of the distribution by month.</p>
<div id="histogram-and-frequency-table-of-accusations-by-month" class="section level4">
<h4 class="hasAnchor">
<a href="#histogram-and-frequency-table-of-accusations-by-month" class="anchor"></a>Histogram and frequency table of accusations by month</h4>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">accused_witches</span><span class="op">)</span> <span class="op">+</span> 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Accusations by month"</span>, x <span class="op">=</span> <span class="st">"Month"</span><span class="op">)</span>  <span class="op">+</span>
       <span class="fu">scale_x_discrete</span><span class="op">(</span>drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
       <span class="va">salem_theme</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-2-1.png" width="480"></p>
<div class="sourceCode" id="cb3"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">accused_witches</span><span class="op">$</span><span class="va">Month.of.Accusation.Name</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span>, 
      dnn <span class="op">=</span> <span class="st">"Month"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Accusations by Month"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>Accusations by Month</caption>
<thead><tr class="header">
<th align="left">Month</th>
<th align="right">Freq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">January</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">February</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">March</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">April</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">May</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="left">June</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">July</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">August</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="left">September</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">October</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">November</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">December</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
</div>
<div id="cumulative-accusations-by-month" class="section level4">
<h4 class="hasAnchor">
<a href="#cumulative-accusations-by-month" class="anchor"></a>Cumulative accusations by month</h4>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">accused_witches</span><span class="op">)</span> <span class="op">+</span> 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Month.of.Accusation.Name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">stat_ecdf</span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, geom <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Cumulative accusations by month"</span>, x <span class="op">=</span> <span class="st">"Month"</span>, 
            y <span class="op">=</span> <span class="st">"Cumulative Accusations"</span><span class="op">)</span>  <span class="op">+</span>
       <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, 
                          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, 
                                     <span class="st">"Jun"</span>, <span class="st">"Jul"</span>,<span class="st">"Aug"</span>, <span class="st">"Sept"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dec"</span><span class="op">)</span> <span class="op">)</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<div class="sourceCode" id="cb5"><pre class="downlit">


<span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">accused_witches</span><span class="op">$</span><span class="va">Month.of.Accusation.Name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">January</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">February</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">March</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">April</td>
<td align="right">29</td>
</tr>
<tr class="odd">
<td align="left">May</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="left">June</td>
<td align="right">71</td>
</tr>
<tr class="odd">
<td align="left">July</td>
<td align="right">83</td>
</tr>
<tr class="even">
<td align="left">August</td>
<td align="right">106</td>
</tr>
<tr class="odd">
<td align="left">September</td>
<td align="right">139</td>
</tr>
<tr class="even">
<td align="left">October</td>
<td align="right">140</td>
</tr>
<tr class="odd">
<td align="left">November</td>
<td align="right">143</td>
</tr>
<tr class="even">
<td align="left">December</td>
<td align="right">143</td>
</tr>
</tbody>
</table>
<p>An alternative approach using dplyr that provides some other options. This approach would also let you add other variables to the new monthly data, whether the number of executions or other data you collect. One advantage of this approach is that it is easier to create a Pareto Histogram as displayed on the website. These examples show three possible ways to display the Pareto histogram. As usual there are other approaches.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">monthly_accusations</span> <span class="op">&lt;-</span> <span class="va">accused_witches</span> <span class="op">%&gt;%</span> 
                      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Month.of.Accusation</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
                      <span class="fu">group_by</span><span class="op">(</span><span class="va">Month.of.Accusation.Name</span><span class="op">)</span> <span class="op">%&gt;%</span>
                      <span class="fu">summarize</span><span class="op">(</span>number <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                      <span class="fu">mutate</span><span class="op">(</span>cumulative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span> <span class="op">)</span>

<span class="va">monthly_accusations</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Accusations by Month"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>Accusations by Month</caption>
<thead><tr class="header">
<th align="left">Month.of.Accusation.Name</th>
<th align="right">number</th>
<th align="right">cumulative</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">February</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">March</td>
<td align="right">4</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">April</td>
<td align="right">22</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td align="left">May</td>
<td align="right">39</td>
<td align="right">68</td>
</tr>
<tr class="odd">
<td align="left">June</td>
<td align="right">3</td>
<td align="right">71</td>
</tr>
<tr class="even">
<td align="left">July</td>
<td align="right">12</td>
<td align="right">83</td>
</tr>
<tr class="odd">
<td align="left">August</td>
<td align="right">23</td>
<td align="right">106</td>
</tr>
<tr class="even">
<td align="left">September</td>
<td align="right">33</td>
<td align="right">139</td>
</tr>
<tr class="odd">
<td align="left">October</td>
<td align="right">1</td>
<td align="right">140</td>
</tr>
<tr class="even">
<td align="left">November</td>
<td align="right">3</td>
<td align="right">143</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit">

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">monthly_accusations</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span>, y <span class="op">=</span> <span class="va">cumulative</span>, group <span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">geom_col</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">number</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Frequency and Cumulative Frequency of Accusations by Month"</span><span class="op">)</span> <span class="op">+</span>
             <span class="va">salem_theme</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
<div class="sourceCode" id="cb8"><pre class="downlit">


 <span class="va">monthly_accusations</span> <span class="op">%&gt;%</span> 
             <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">number</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
            <span class="fu">mutate</span><span class="op">(</span>Month.of.Accusation.Name <span class="op">=</span> 
                   <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Month.of.Accusation.Name</span>, 
                         levels<span class="op">=</span><span class="va">Month.of.Accusation.Name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
            <span class="fu">mutate</span><span class="op">(</span>pareto_cumulative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span> <span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span>, y <span class="op">=</span> <span class="va">number</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Pareto Histogram of Accusations by Month"</span><span class="op">)</span> <span class="op">+</span>
             <span class="va">salem_theme</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-4-2.png" width="480"></p>
<div class="sourceCode" id="cb9"><pre class="downlit">


<span class="va">monthly_accusations</span> <span class="op">%&gt;%</span> 
            <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">number</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
            <span class="fu">mutate</span><span class="op">(</span>Month.of.Accusation.Name <span class="op">=</span> 
                   <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Month.of.Accusation.Name</span>, 
                         levels<span class="op">=</span><span class="va">Month.of.Accusation.Name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
            <span class="fu">mutate</span><span class="op">(</span>pareto_cumulative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span> <span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span>, y <span class="op">=</span> <span class="va">pareto_cumulative</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">geom_point</span><span class="op">(</span> <span class="op">)</span> <span class="op">+</span>
             <span class="fu">geom_path</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">pareto_cumulative</span>, group<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">"blue"</span>, lty<span class="op">=</span><span class="fl">3</span>, size<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Pareto Cumulative Distribution of Accusations by Month"</span><span class="op">)</span> <span class="op">+</span>
             <span class="va">salem_theme</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-4-3.png" width="480"></p>
<div class="sourceCode" id="cb10"><pre class="downlit">


 <span class="va">monthly_accusations</span> <span class="op">%&gt;%</span> 
             <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">number</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
            <span class="fu">mutate</span><span class="op">(</span>Month.of.Accusation.Name <span class="op">=</span> 
                   <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Month.of.Accusation.Name</span>, 
                         levels <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
            <span class="fu">mutate</span><span class="op">(</span>pareto_cumulative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span> <span class="op">)</span> <span class="op">%&gt;%</span>
        <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span>, y <span class="op">=</span> <span class="va">number</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">geom_path</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">pareto_cumulative</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"blue"</span>, lty<span class="op">=</span><span class="fl">3</span>, size<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Pareto Histogram of Accusations by Month"</span><span class="op">)</span> <span class="op">+</span>
             <span class="va">salem_theme</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-4-4.png" width="480"></p>
</div>
<div id="executions" class="section level3">
<h3 class="hasAnchor">
<a href="#executions" class="anchor"></a>Executions</h3>
<p>Creating the bar chart of executions over time is similar to creating that for accusations. Additionally, these are shown as what is termed scatterplots but now would be called line graphs.</p>
<p>Since most accused were not executed (and this is indicated by setting them to NA or missing) we’ll remove the missing cases from the graph.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">accused_witches</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month.of.Execution.Name</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Executions by month"</span>, x <span class="op">=</span> <span class="st">"Month"</span><span class="op">)</span>  <span class="op">+</span>
       <span class="fu">scale_x_discrete</span><span class="op">(</span>drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
       <span class="va">salem_theme</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-5-1.png" width="480"></p>
<div class="sourceCode" id="cb12"><pre class="downlit">


<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">accused_witches</span><span class="op">$</span><span class="va">Month.of.Execution.Name</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span>, 
      dnn <span class="op">=</span> <span class="st">"Month"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Executions by Month"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>Executions by Month</caption>
<thead><tr class="header">
<th align="left">Month</th>
<th align="right">Freq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">January</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">February</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">March</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">April</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">May</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">June</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">July</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">August</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">September</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">October</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">November</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">December</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="right">132</td>
</tr>
</tbody>
</table>
<p>There are many ways to explore the relationship between executions and accusations. On the website this is displayed using overlapping line plots of the number of executions in a month and the number of accusations. If teaching, it is important to point out that the execuations in a month were not generally of the same people who were accused in that month. To reproduce this, one approach is to again use summarize() to create a monthly data set.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">

<span class="va">monthly_accused</span> <span class="op">&lt;-</span> <span class="va">accused_witches</span> <span class="op">%&gt;%</span> 
                      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Month.of.Accusation</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
                      <span class="fu">group_by</span><span class="op">(</span><span class="va">Month.of.Accusation.Name</span><span class="op">)</span> <span class="op">%&gt;%</span>
                      <span class="fu">summarize</span><span class="op">(</span>accusations <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span>
                      <span class="fu">rename</span><span class="op">(</span>Month <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span><span class="op">)</span>
<span class="va">monthly_executed</span> <span class="op">&lt;-</span> <span class="va">accused_witches</span> <span class="op">%&gt;%</span> 
                      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Month.of.Execution</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
                      <span class="fu">group_by</span><span class="op">(</span><span class="va">Month.of.Execution.Name</span><span class="op">)</span> <span class="op">%&gt;%</span>
                      <span class="fu">summarize</span><span class="op">(</span>executions <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
                      <span class="fu">rename</span><span class="op">(</span>Month <span class="op">=</span> <span class="va">Month.of.Execution.Name</span><span class="op">)</span>
<span class="va">monthly_data</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">monthly_accused</span>, <span class="va">monthly_executed</span><span class="op">)</span> <span class="op">%&gt;%</span>
                          <span class="fu">mutate</span><span class="op">(</span>executions <span class="op">=</span> 
                                   <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">executions</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">executions</span><span class="op">)</span><span class="op">)</span>


<span class="fu">ggplot</span><span class="op">(</span><span class="va">monthly_data</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month</span>, y <span class="op">=</span> <span class="va">accusations</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu">geom_path</span><span class="op">(</span> color <span class="op">=</span> <span class="st">"blue"</span> <span class="op">)</span> <span class="op">+</span>
     <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">executions</span>, x <span class="op">=</span> <span class="va">Month</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Executions and Accusations by Month"</span>,
          subtitle <span class="op">=</span> <span class="st">"Accusations in blue and executions in red"</span><span class="op">)</span> <span class="op">+</span>
     <span class="va">salem_theme</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
</div>
<div id="geographic-spread-of-accusations" class="section level3">
<h3 class="hasAnchor">
<a href="#geographic-spread-of-accusations" class="anchor"></a>Geographic Spread of Accusations</h3>
<p>The pivot table of month of accusation by town. However that table is huge and only the first seven columns are shown on the website. A more compact display is given below rather than using kable(). Also note that the row and column totals are added.</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span> <span class="va">accused_witches</span><span class="op">$</span><span class="va">Month.of.Accusation.Name</span>, <span class="va">accused_witches</span><span class="op">$</span><span class="va">Residence</span>,
        dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Month"</span>, <span class="st">"Residence"</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt;            Residence</span>
<span class="co">#&gt; Month       Amesbury Andover Beverly Billerica Boston Boxford Charlestown</span>
<span class="co">#&gt;   January          0       0       0         0      0       0           0</span>
<span class="co">#&gt;   February         0       0       0         0      0       0           0</span>
<span class="co">#&gt;   March            0       0       0         0      0       0           0</span>
<span class="co">#&gt;   April            1       0       2         0      0       0           0</span>
<span class="co">#&gt;   May              0       1       1         3      2       0           2</span>
<span class="co">#&gt;   June             0       0       1         0      0       0           0</span>
<span class="co">#&gt;   July             0       6       0         0      0       0           0</span>
<span class="co">#&gt;   August           0      12       0         0      0       3           0</span>
<span class="co">#&gt;   September        0      23       0         0      0       0           0</span>
<span class="co">#&gt;   October          0       0       0         0      0       0           0</span>
<span class="co">#&gt;   November         0       0       0         0      0       0           0</span>
<span class="co">#&gt;   December         0       0       0         0      0       0           0</span>
<span class="co">#&gt;   Sum              1      42       4         3      2       3           2</span>
<span class="co">#&gt;            Residence</span>
<span class="co">#&gt; Month       Chelmsford Gloucester Haverhill Ipswich Lynn Malden Manchester</span>
<span class="co">#&gt;   January            0          0         0       0    0      0          0</span>
<span class="co">#&gt;   February           0          0         0       0    0      0          0</span>
<span class="co">#&gt;   March              0          0         0       1    0      0          0</span>
<span class="co">#&gt;   April              0          0         0       0    0      0          0</span>
<span class="co">#&gt;   May                0          0         0       2    3      1          0</span>
<span class="co">#&gt;   June               0          0         0       0    1      0          0</span>
<span class="co">#&gt;   July               0          0         3       0    0      0          0</span>
<span class="co">#&gt;   August             0          0         3       0    0      0          0</span>
<span class="co">#&gt;   September          0          3         0       0    0      0          1</span>
<span class="co">#&gt;   October            0          0         0       0    1      0          0</span>
<span class="co">#&gt;   November           0          3         0       0    0      0          0</span>
<span class="co">#&gt;   December           0          0         0       0    0      0          0</span>
<span class="co">#&gt;   Sum                0          6         6       3    5      1          1</span>
<span class="co">#&gt;            Residence</span>
<span class="co">#&gt; Month       Marblehead Piscataqua, Maine Reading Rowley Salem Town</span>
<span class="co">#&gt;   January            0                 0       0      0          0</span>
<span class="co">#&gt;   February           0                 0       0      0          0</span>
<span class="co">#&gt;   March              0                 0       0      0          1</span>
<span class="co">#&gt;   April              0                 0       1      0          7</span>
<span class="co">#&gt;   May                1                 0       3      0         11</span>
<span class="co">#&gt;   June               0                 0       0      0          1</span>
<span class="co">#&gt;   July               0                 0       0      0          2</span>
<span class="co">#&gt;   August             0                 0       0      5          0</span>
<span class="co">#&gt;   September          0                 1       3      0          2</span>
<span class="co">#&gt;   October            0                 0       0      0          0</span>
<span class="co">#&gt;   November           0                 0       0      0          0</span>
<span class="co">#&gt;   December           0                 0       0      0          0</span>
<span class="co">#&gt;   Sum                1                 1       7      5         24</span>
<span class="co">#&gt;            Residence</span>
<span class="co">#&gt; Month       Salem Village Salisbury Topsfield Wells, Maine Woburn Sum</span>
<span class="co">#&gt;   January               0         0         0            0      0   0</span>
<span class="co">#&gt;   February              3         0         0            0      0   3</span>
<span class="co">#&gt;   March                 2         0         0            0      0   4</span>
<span class="co">#&gt;   April                 4         0         6            1      0  22</span>
<span class="co">#&gt;   May                   6         0         0            0      3  39</span>
<span class="co">#&gt;   June                  0         0         0            0      0   3</span>
<span class="co">#&gt;   July                  0         1         0            0      0  12</span>
<span class="co">#&gt;   August                0         0         0            0      0  23</span>
<span class="co">#&gt;   September             0         0         0            0      0  33</span>
<span class="co">#&gt;   October               0         0         0            0      0   1</span>
<span class="co">#&gt;   November              0         0         0            0      0   3</span>
<span class="co">#&gt;   December              0         0         0            0      0   0</span>
<span class="co">#&gt;   Sum                  15         1         6            1      3 143</span></pre></div>
<p>The site discusses the “grand total” data (the row sum) as reflecting the varying intensity in the different towns. This can also be shown using a univariate table (or dplyr::summarize())</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">accused_witches</span><span class="op">$</span><span class="va">Residence</span>, dnn <span class="op">=</span> <span class="st">"Residence"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Residences of Accused"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>Residences of Accused</caption>
<thead><tr class="header">
<th align="left">Residence</th>
<th align="right">Freq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Amesbury</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Andover</td>
<td align="right">45</td>
</tr>
<tr class="odd">
<td align="left">Beverly</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Billerica</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Boston</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Boxford</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Charlestown</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Chelmsford</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Gloucester</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">Haverhill</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Ipswich</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Lynn</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">Malden</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Manchester</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Marblehead</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Piscataqua, Maine</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Reading</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">Rowley</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">Salem Town</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">Salem Village</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">Salisbury</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Topsfield</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Wells, Maine</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Woburn</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit">

<span class="va">accused_witches</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">Residence</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span>number <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
     <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Residences of Accused"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>Residences of Accused</caption>
<thead><tr class="header">
<th align="left">Residence</th>
<th align="right">number</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Amesbury</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Andover</td>
<td align="right">45</td>
</tr>
<tr class="odd">
<td align="left">Beverly</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Billerica</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Boston</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Boxford</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Charlestown</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Chelmsford</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Gloucester</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">Haverhill</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Ipswich</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Lynn</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">Malden</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Manchester</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Marblehead</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Piscataqua, Maine</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Reading</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">Rowley</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">Salem Town</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">Salem Village</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">Salisbury</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Topsfield</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Wells, Maine</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Woburn</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>The website contains a towns data set that essentially reproduces the large contingency table. This makes sense to do in Excel, but in R we do not need to makea separate data set.</p>
<p>To make a histogram for each town we can select the town we want. This is illustrated below for Andover.</p>
<p>Note that in the data set the white space from the beginning and ending of the place names has been removed.</p>
<div class="sourceCode" id="cb17"><pre class="downlit">

<span class="va">accused_witches</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Residence</span> <span class="op">==</span> <span class="st">"Andover"</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">scale_x_discrete</span><span class="op">(</span>drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
   <span class="va">salem_theme</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
<p>The website encourages examining the period before and after the convening of the Court of Oyer and Terminer in June.<br>
To help make this more visible we can add a vline.</p>
<div class="sourceCode" id="cb18"><pre class="downlit">

<span class="va">accused_witches</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Residence</span> <span class="op">==</span> <span class="st">"Andover"</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">6.5</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">scale_x_discrete</span><span class="op">(</span>drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Accusations by Month"</span>, 
       subtitle <span class="op">=</span> <span class="st">"Red line indicates reconvening of the Court of Oyer and Terminer"</span>,
       x <span class="op">=</span> <span class="st">"Month of accusation"</span><span class="op">)</span> <span class="op">+</span>
   <span class="va">salem_theme</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-10-1.png" width="480"></p>
<p>Alternatively, we can use faceting to show all of the histograms.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">

<span class="va">accused_witches</span> <span class="op">%&gt;%</span> 
   <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month.of.Accusation.Name</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">6.5</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">scale_x_discrete</span><span class="op">(</span>drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">facet_wrap</span><span class="op">(</span>facets <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">Residence</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of accusations by month"</span>,
        subtitle <span class="op">=</span> <span class="st">"Red line indicates reconvening of the Court of Oyer and Terminer"</span>,
        x <span class="op">=</span> <span class="st">"Month of Accusation"</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
<div id="maps" class="section level3">
<h3 class="hasAnchor">
<a href="#maps" class="anchor"></a>Maps</h3>
<p>We can use maps to represent the geographic distribution over time spatially. The salem_region data set is an sf (simple features) data set that provides geographic data for the towns in the three Massachuessets counties represented in our data: Essex, Middlesex and Sussex.</p>
<p>To use this data you will need to install the sf package. The code at the start of the second code chunk tests for whether you have done this.</p>
<p>Not all of the towns in these three counties had accusations: the majority did not. The data also include the total accused for each town and the monthly accused for the towns that ever had an accusation. However, these variables should <em>never</em> be used outside of maps because the results will be incorrect. This is because many towns have multiple records. This is especially true if they include islands, which is common in this region of the state. These are based on modern municipal boundaries which are close to but not the same as the historical ones. There are many geographic analyses that can be done. Below a comparison of the distribution of whether towns had at least on accusation in each of four months is given.</p>
<p>First, create variables indicating whether towns did or did not have an accusation in a month and remove the TOWN_LABELs for all the towns that never had an accusation.</p>
<div class="sourceCode" id="cb20"><pre class="downlit">

<span class="va">newdata</span> <span class="op">&lt;-</span> <span class="va">salem_region</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>February.Any <span class="op">=</span> <span class="va">February</span> <span class="op">&gt;</span> <span class="fl">0</span>, March.Any <span class="op">=</span> <span class="va">March</span> <span class="op">&gt;</span> <span class="fl">0</span>,
                                   April.Any <span class="op">=</span> <span class="va">April</span> <span class="op">&gt;</span> <span class="fl">0</span>, May.Any <span class="op">=</span> <span class="va">May</span> <span class="op">&gt;</span> <span class="fl">0</span>,
                                   June.Any <span class="op">=</span> <span class="va">June</span> <span class="op">&gt;</span> <span class="fl">0</span>, July.Any <span class="op">=</span> <span class="va">July</span> <span class="op">&gt;</span> <span class="fl">0</span>,
                                   August.Any <span class="op">=</span> <span class="va">August</span> <span class="op">&gt;</span> <span class="fl">0</span>, 
                                   September.Any <span class="op">=</span> <span class="va">September</span> <span class="op">&gt;</span><span class="fl">0</span>,
                                   October.Any <span class="op">=</span> <span class="va">October</span> <span class="op">&gt;</span> <span class="fl">0</span>,
                                   November.Any <span class="op">=</span> <span class="va">November</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>

<span class="va">newdata</span><span class="op">$</span><span class="va">TOWN_LABEL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">newdata</span><span class="op">$</span><span class="va">n_accused</span> <span class="op">==</span> <span class="fl">0</span>, <span class="cn">NA</span>,  <span class="va">newdata</span><span class="op">$</span><span class="va">TOWN_LABEL</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"sf"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">newdata</span><span class="op">)</span> 
      <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">geom_sf_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">TOWN_LABEL</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">2</span>, nudge_x <span class="op">=</span> <span class="fl">5</span>,
                      nudge_y <span class="op">=</span> <span class="fl">5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
      <span class="va">p3</span> <span class="op">&lt;-</span>       <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"grey"</span>, <span class="st">"red"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> 
<span class="op">}</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"sf"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">p1</span>  <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">newdata</span>,  <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">February.Any</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
        <span class="va">p3</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Location of Accusations in February"</span><span class="op">)</span> 
<span class="op">}</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"sf"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">p1</span> <span class="op">+</span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">newdata</span>,  <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">July.Any</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
        <span class="va">p3</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Location of Accusations in July"</span><span class="op">)</span> 
<span class="op">}</span>     </pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-13-2.png" width="768"></p>
<div class="sourceCode" id="cb23"><pre class="downlit">
 <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"sf"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>     
      <span class="va">p1</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">newdata</span>,  <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">August.Any</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
        <span class="va">p3</span> <span class="op">+</span> <span class="va">p2</span>  <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Location of Accusations in August"</span><span class="op">)</span> 
 <span class="op">}</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-13-3.png" width="768"></p>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"sf"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">p1</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">newdata</span>,  <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">November.Any</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
        <span class="va">p3</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Location of Accusations in November"</span><span class="op">)</span> 
<span class="op">}</span></pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-13-4.png" width="768"></p>
</div>
</div>
<div id="social-conflict" class="section level2">
<h2 class="hasAnchor">
<a href="#social-conflict" class="anchor"></a>Social Conflict</h2>
<p>The website explores a variety of dimensions of social conflict in the Salem region. One of the important social cleavages was between those who did or did not support Reverend Parris, who had been appointed as the minister for the new church in Salem Village. (This was the Puritan church, which was the official church in Massacheusetts.)</p>
<p>The site has two data sets, one of pro-Parris individuals and one of anti-Parris individuals. For use in R these have been combined with an added variable identifying the position of the indivual. This data set is called parris_social. Also the original column label for the anti-Parris data was “[Church] Member” while for the pro-Parris data it was “Church-Member.” In the parris_social data Church-Member is used. Using the variable <code>view</code> it can be subset to pro- and anti- groups. However it is not necessary to do this.</p>
<p>A three-way table can be created, as one example. Two ways of doing this are shown. Marginals and proportions could be added.</p>
<div class="sourceCode" id="cb25"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">parris_social</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">parris_social</span><span class="op">$</span><span class="va">Identification</span>, <span class="va">parris_social</span><span class="op">$</span><span class="va">view</span>,
      dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Identification"</span>, <span class="st">"View"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; , , View = Anti-Parris</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    Identification</span>
<span class="co">#&gt; Sex Church-Member Free-Holder Householder Non-Member Young men. 16 years old</span>
<span class="co">#&gt;   F            11           0           0         16                       0</span>
<span class="co">#&gt;   M             6           5          29          0                      17</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , View = Pro-Parris</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    Identification</span>
<span class="co">#&gt; Sex Church-Member Free-Holder Householder Non-Member Young men. 16 years old</span>
<span class="co">#&gt;   F            27           0          24          0                       0</span>
<span class="co">#&gt;   M            25           0          29          0                       0</span>

<span class="fu"><a href="https://rdrr.io/r/stats/ftable.html">ftable</a></span><span class="op">(</span><span class="va">parris_social</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">parris_social</span><span class="op">$</span><span class="va">Identification</span>, <span class="va">parris_social</span><span class="op">$</span><span class="va">view</span>,
      dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Identification"</span>, <span class="st">"View"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                             View Anti-Parris Pro-Parris</span>
<span class="co">#&gt; Sex Identification                                     </span>
<span class="co">#&gt; F   Church-Member                         11         27</span>
<span class="co">#&gt;     Free-Holder                            0          0</span>
<span class="co">#&gt;     Householder                            0         24</span>
<span class="co">#&gt;     Non-Member                            16          0</span>
<span class="co">#&gt;     Young men. 16 years old                0          0</span>
<span class="co">#&gt; M   Church-Member                          6         25</span>
<span class="co">#&gt;     Free-Holder                            5          0</span>
<span class="co">#&gt;     Householder                           29         29</span>
<span class="co">#&gt;     Non-Member                             0          0</span>
<span class="co">#&gt;     Young men. 16 years old               17          0</span></pre></div>
<p>Treating position on Parris as the dependent varable, we might rearrange the tables.</p>
<div class="sourceCode" id="cb26"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">parris_social</span><span class="op">$</span><span class="va">view</span>, <span class="va">parris_social</span><span class="op">$</span><span class="va">Identification</span>, <span class="va">parris_social</span><span class="op">$</span><span class="va">Sex</span>, 
      dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"View"</span>, <span class="st">"Identification"</span>, <span class="st">"Sex"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; , , Sex = F</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              Identification</span>
<span class="co">#&gt; View          Church-Member Free-Holder Householder Non-Member</span>
<span class="co">#&gt;   Anti-Parris            11           0           0         16</span>
<span class="co">#&gt;   Pro-Parris             27           0          24          0</span>
<span class="co">#&gt;              Identification</span>
<span class="co">#&gt; View          Young men. 16 years old</span>
<span class="co">#&gt;   Anti-Parris                       0</span>
<span class="co">#&gt;   Pro-Parris                        0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , Sex = M</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              Identification</span>
<span class="co">#&gt; View          Church-Member Free-Holder Householder Non-Member</span>
<span class="co">#&gt;   Anti-Parris             6           5          29          0</span>
<span class="co">#&gt;   Pro-Parris             25           0          29          0</span>
<span class="co">#&gt;              Identification</span>
<span class="co">#&gt; View          Young men. 16 years old</span>
<span class="co">#&gt;   Anti-Parris                      17</span>
<span class="co">#&gt;   Pro-Parris                        0</span>

<span class="fu"><a href="https://rdrr.io/r/stats/ftable.html">ftable</a></span><span class="op">(</span> <span class="va">parris_social</span><span class="op">$</span><span class="va">Identification</span>, <span class="va">parris_social</span><span class="op">$</span><span class="va">view</span>,  <span class="va">parris_social</span><span class="op">$</span><span class="va">Sex</span>,
      dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"View"</span>, <span class="st">"Identification"</span>, <span class="st">"Sex"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                                        Sex  F  M</span>
<span class="co">#&gt; View                    Identification          </span>
<span class="co">#&gt; Church-Member           Anti-Parris        11  6</span>
<span class="co">#&gt;                         Pro-Parris         27 25</span>
<span class="co">#&gt; Free-Holder             Anti-Parris         0  5</span>
<span class="co">#&gt;                         Pro-Parris          0  0</span>
<span class="co">#&gt; Householder             Anti-Parris         0 29</span>
<span class="co">#&gt;                         Pro-Parris         24 29</span>
<span class="co">#&gt; Non-Member              Anti-Parris        16  0</span>
<span class="co">#&gt;                         Pro-Parris          0  0</span>
<span class="co">#&gt; Young men. 16 years old Anti-Parris         0 17</span>
<span class="co">#&gt;                         Pro-Parris          0  0</span></pre></div>
<p>The parris_social data set focuses on those who signed pro- and anti-Parris petitions. In contrast, the salem_village data set includes individuals who did not sign petitions in addition to those who did. However, it is limited to those who paid taxes so many of the young men and women of all ages who are in the parris_social data are not included. This also includes data from multiple years.</p>
<p>The basic table for this is the analysis of church membership and position on Parris.</p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">salem_village</span><span class="op">$</span><span class="va">Petition</span>, <span class="va">salem_village</span><span class="op">$</span><span class="va">Church.to.1696</span>, 
      dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"Membership"</span>, <span class="st">"View"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;           View</span>
<span class="co">#&gt; Membership Church Non-Church</span>
<span class="co">#&gt;     Anti-P      8         32</span>
<span class="co">#&gt;     NoS         1         43</span>
<span class="co">#&gt;     Pro-P      25         28</span>

<span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">salem_village</span><span class="op">$</span><span class="va">Petition</span>, <span class="va">salem_village</span><span class="op">$</span><span class="va">Church.to.1696</span>, 
      dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"Membership"</span>, <span class="st">"View"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;           View</span>
<span class="co">#&gt; Membership Church Non-Church Sum</span>
<span class="co">#&gt;     Anti-P      8         32  40</span>
<span class="co">#&gt;     NoS         1         43  44</span>
<span class="co">#&gt;     Pro-P      25         28  53</span>
<span class="co">#&gt;     Sum        34        103 137</span></pre></div>
<div id="political-power" class="section level3">
<h3 class="hasAnchor">
<a href="#political-power" class="anchor"></a>Political Power</h3>
<p>As explained on the website, the Village of Salem was governed by a Committee of Five in addition to the Town Meeting <a href="https://www.tulane.edu/~salem/Politics%20Intro.html">see Salem Village Politics</a>.</p>
<p>The data set that is part of this package called committee_list is structured differently than the original data. It is in “long” format with one row per person-year for each committee member for the years they served. This can be coverted to various other formats if desired.</p>
<p>You can make a table see how the make up of the committee changed over the period from 1687 to 1698.</p>
<div class="sourceCode" id="cb28"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">committee_list</span><span class="op">$</span><span class="va">Petition</span>, <span class="va">committee_list</span><span class="op">$</span><span class="va">Year</span>, dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Petition"</span>, <span class="st">"Year"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;         Year</span>
<span class="co">#&gt; Petition 1685 1686 1687 1688 1689 1690 1691 1692 1693 1694 1695 1696 1697 1698</span>
<span class="co">#&gt;   Anti-P    1    1    2    2    2    2    5    4    4    0    0    0    2    2</span>
<span class="co">#&gt;   NoS       1    1    0    0    0    0    0    0    1    0    1    0    0    0</span>
<span class="co">#&gt;   Pro-P     3    3    3    2    3    3    0    1    0    5    4    5    3    3</span></pre></div>
<p>The website shows a complex pivot table involving three variables.</p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span> <span class="va">committee_list</span><span class="op">$</span><span class="va">Petition</span>, <span class="va">committee_list</span><span class="op">$</span><span class="va">Social</span>, <span class="va">committee_list</span><span class="op">$</span><span class="va">Year</span> <span class="op">)</span>
<span class="co">#&gt; , ,  = 1685</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             0          0           1</span>
<span class="co">#&gt;   NoS                0          0           1</span>
<span class="co">#&gt;   Pro-P              2          0           1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1686</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             1          0           0</span>
<span class="co">#&gt;   NoS                0          0           1</span>
<span class="co">#&gt;   Pro-P              3          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1687</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             1          1           0</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              3          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1688</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             0          0           2</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              2          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1689</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             1          0           1</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              3          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1690</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             1          0           1</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              3          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1691</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             0          0           5</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              0          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1692</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             1          0           3</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              1          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1693</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             1          0           3</span>
<span class="co">#&gt;   NoS                0          0           1</span>
<span class="co">#&gt;   Pro-P              0          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1694</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             0          0           0</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              5          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1695</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             0          0           0</span>
<span class="co">#&gt;   NoS                0          0           1</span>
<span class="co">#&gt;   Pro-P              4          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1696</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             0          0           0</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              3          0           2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1697</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             1          0           1</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              3          0           0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , ,  = 1698</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             0          0           2</span>
<span class="co">#&gt;   NoS                0          0           0</span>
<span class="co">#&gt;   Pro-P              3          0           0</span></pre></div>
<p>One way to explore the association is to cross tabulate the Petition and Social variables. However, this counts the same people multiple times if they served for multiple years.</p>
<div class="sourceCode" id="cb30"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span> <span class="va">committee_list</span><span class="op">$</span><span class="va">Petition</span>, <span class="va">committee_list</span><span class="op">$</span><span class="va">Social</span> <span class="op">)</span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder</span>
<span class="co">#&gt;   Anti-P             7          1          19</span>
<span class="co">#&gt;   NoS                0          0           4</span>
<span class="co">#&gt;   Pro-P             35          0           3</span></pre></div>
<p>To adjust for this and get the data matching the website we need to remove those duplicates. Then the table matches that found at <a href="https://www.tulane.edu/~salem/Committeemen%20Social%20Report.html">Committee Social Report</a>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="va">committee_list2</span> <span class="op">&lt;-</span>  <span class="va">committee_list</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">Committee.Members</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                             <span class="fu">summarize</span><span class="op">(</span>Social <span class="op">=</span> <span class="fu">first</span><span class="op">(</span><span class="va">Social</span><span class="op">)</span>, 
                                       Petition <span class="op">=</span> <span class="fu">first</span><span class="op">(</span><span class="va">Petition</span><span class="op">)</span>,
                                       Terms <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html">addmargins</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span> <span class="va">committee_list2</span><span class="op">$</span><span class="va">Petition</span>, <span class="va">committee_list2</span><span class="op">$</span><span class="va">Social</span> <span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          Church Member Freeholder Householder Sum</span>
<span class="co">#&gt;   Anti-P             4          1          10  15</span>
<span class="co">#&gt;   NoS                0          0           3   3</span>
<span class="co">#&gt;   Pro-P             10          0           3  13</span>
<span class="co">#&gt;   Sum               14          1          16  31</span></pre></div>
</div>
<div id="wealth-and-salem-village-conflict" class="section level3">
<h3 class="hasAnchor">
<a href="#wealth-and-salem-village-conflict" class="anchor"></a>Wealth and Salem Village Conflict</h3>
<p>The tax_comparison data set is also set up in long format. This can then be used to create a comparison table similar to the table on <a href="https://www.tulane.edu/~salem/1690%20Tax%20Comparisons.html">Tax Comparison</a>. One limitation is that R does not have a built in function for the mode.</p>
<p>This is the most complex analysis on the website. Complications include people moving in and out of the data in different years (individuals appear between one and six times), the changing amount of taxes over the time period and name changes. The analysis looks at both group and individual level comparisons and individual level mobility.</p>
<p>Here is the distribution of tax payers by year.</p>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">tax_comparison</span><span class="op">$</span><span class="va">Year</span>, dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Tax payers by year"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>Tax payers by year</caption>
<thead><tr class="header">
<th align="left">Year</th>
<th align="right">Freq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1681</td>
<td align="right">94</td>
</tr>
<tr class="even">
<td align="left">1690</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="left">1694</td>
<td align="right">105</td>
</tr>
<tr class="even">
<td align="left">1695</td>
<td align="right">105</td>
</tr>
<tr class="odd">
<td align="left">1697</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left">1700</td>
<td align="right">114</td>
</tr>
</tbody>
</table>
<p>The next table summarizes descriptive statistics for all of the years. The website general shows one year at a time or in some cases compares two years. You can add <code><a href="https://rdrr.io/r/stats/filter.html">filter(Year = 1681)</a></code> to display only the 1681 data, changing the filter to select whatever years you want. For example to select all of the data for 1681 through 1694 one way would be to add <code>select(Year &gt;= 1691 &amp; Year &lt;= 1694)</code>.</p>
<p>Let’s start by looking at the group level data.</p>
<p>The first table is for everyone in a year. The second separates the data based on which petition the tax payer signed (or if they) did not sign.</p>
<div class="sourceCode" id="cb33"><pre class="downlit">
<span class="va">tax_comparison</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">Year</span><span class="op">)</span> <span class="op">%&gt;%</span>
            <span class="fu">summarize</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,
                                   minimum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>,
                      maximum <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, range <span class="op">=</span> <span class="va">maximum</span> <span class="op">-</span> <span class="va">minimum</span>, 
                      sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, Count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                      <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Taxes paid by year"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>Taxes paid by year</caption>
<thead><tr class="header">
<th align="left">Year</th>
<th align="right">mean</th>
<th align="right">median</th>
<th align="right">minimum</th>
<th align="right">maximum</th>
<th align="right">range</th>
<th align="right">sum</th>
<th align="right">Count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1681</td>
<td align="right">42.5</td>
<td align="right">30.0</td>
<td align="right">2.25</td>
<td align="right">206.25</td>
<td align="right">204</td>
<td align="right">3992.0</td>
<td align="right">94</td>
</tr>
<tr class="even">
<td align="left">1690</td>
<td align="right">13.2</td>
<td align="right">8.0</td>
<td align="right">2.00</td>
<td align="right">50.00</td>
<td align="right">48</td>
<td align="right">1323.5</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="left">1694</td>
<td align="right">11.7</td>
<td align="right">9.0</td>
<td align="right">3.00</td>
<td align="right">52.00</td>
<td align="right">49</td>
<td align="right">1229.0</td>
<td align="right">105</td>
</tr>
<tr class="even">
<td align="left">1695</td>
<td align="right">11.6</td>
<td align="right">8.0</td>
<td align="right">3.00</td>
<td align="right">58.00</td>
<td align="right">55</td>
<td align="right">1222.5</td>
<td align="right">105</td>
</tr>
<tr class="odd">
<td align="left">1697</td>
<td align="right">16.1</td>
<td align="right">12.0</td>
<td align="right">3.00</td>
<td align="right">75.00</td>
<td align="right">72</td>
<td align="right">1605.5</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left">1700</td>
<td align="right">12.5</td>
<td align="right">9.5</td>
<td align="right">3.00</td>
<td align="right">46.00</td>
<td align="right">43</td>
<td align="right">1428.0</td>
<td align="right">114</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb34"><pre class="downlit">



<span class="va">tax_comparison</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">Year</span>, <span class="va">Petition</span><span class="op">)</span> <span class="op">%&gt;%</span>
            <span class="fu">summarize</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,
                                   minimum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>,
                      maximum <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, range <span class="op">=</span> <span class="va">maximum</span> <span class="op">-</span> <span class="va">minimum</span>, 
                      sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, Tax_payers <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                      <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Taxes paid by year and petition signed"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>Taxes paid by year and petition signed</caption>
<thead><tr class="header">
<th align="left">Year</th>
<th align="left">Petition</th>
<th align="right">mean</th>
<th align="right">median</th>
<th align="right">minimum</th>
<th align="right">maximum</th>
<th align="right">range</th>
<th align="right">sum</th>
<th align="right">Tax_payers</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1681</td>
<td align="left">Anti-P</td>
<td align="right">62.9</td>
<td align="right">51.0</td>
<td align="right">16.00</td>
<td align="right">166.00</td>
<td align="right">150.0</td>
<td align="right">1509.25</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">1681</td>
<td align="left">NoS</td>
<td align="right">26.4</td>
<td align="right">18.0</td>
<td align="right">2.25</td>
<td align="right">206.25</td>
<td align="right">204.0</td>
<td align="right">1268.25</td>
<td align="right">48</td>
</tr>
<tr class="odd">
<td align="left">1681</td>
<td align="left">Pro-P</td>
<td align="right">55.2</td>
<td align="right">40.8</td>
<td align="right">9.00</td>
<td align="right">190.00</td>
<td align="right">181.0</td>
<td align="right">1214.50</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">1690</td>
<td align="left">Anti-P</td>
<td align="right">15.8</td>
<td align="right">14.0</td>
<td align="right">4.00</td>
<td align="right">50.00</td>
<td align="right">46.0</td>
<td align="right">538.00</td>
<td align="right">34</td>
</tr>
<tr class="odd">
<td align="left">1690</td>
<td align="left">NoS</td>
<td align="right">8.0</td>
<td align="right">5.5</td>
<td align="right">2.00</td>
<td align="right">30.00</td>
<td align="right">28.0</td>
<td align="right">224.50</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="left">1690</td>
<td align="left">Pro-P</td>
<td align="right">14.8</td>
<td align="right">14.0</td>
<td align="right">3.00</td>
<td align="right">40.00</td>
<td align="right">37.0</td>
<td align="right">561.00</td>
<td align="right">38</td>
</tr>
<tr class="odd">
<td align="left">1694</td>
<td align="left">Anti-P</td>
<td align="right">14.4</td>
<td align="right">10.5</td>
<td align="right">4.50</td>
<td align="right">52.00</td>
<td align="right">47.5</td>
<td align="right">531.00</td>
<td align="right">37</td>
</tr>
<tr class="even">
<td align="left">1694</td>
<td align="left">NoS</td>
<td align="right">7.0</td>
<td align="right">5.8</td>
<td align="right">3.00</td>
<td align="right">24.00</td>
<td align="right">21.0</td>
<td align="right">111.50</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="left">1694</td>
<td align="left">Pro-P</td>
<td align="right">11.3</td>
<td align="right">9.0</td>
<td align="right">3.50</td>
<td align="right">38.00</td>
<td align="right">34.5</td>
<td align="right">586.50</td>
<td align="right">52</td>
</tr>
<tr class="even">
<td align="left">1695</td>
<td align="left">Anti-P</td>
<td align="right">15.1</td>
<td align="right">11.2</td>
<td align="right">4.00</td>
<td align="right">58.00</td>
<td align="right">54.0</td>
<td align="right">545.00</td>
<td align="right">36</td>
</tr>
<tr class="odd">
<td align="left">1695</td>
<td align="left">NoS</td>
<td align="right">6.6</td>
<td align="right">6.0</td>
<td align="right">3.00</td>
<td align="right">24.00</td>
<td align="right">21.0</td>
<td align="right">111.50</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">1695</td>
<td align="left">Pro-P</td>
<td align="right">10.9</td>
<td align="right">8.0</td>
<td align="right">3.00</td>
<td align="right">40.00</td>
<td align="right">37.0</td>
<td align="right">566.00</td>
<td align="right">52</td>
</tr>
<tr class="odd">
<td align="left">1697</td>
<td align="left">Anti-P</td>
<td align="right">19.0</td>
<td align="right">13.5</td>
<td align="right">3.00</td>
<td align="right">75.00</td>
<td align="right">72.0</td>
<td align="right">722.50</td>
<td align="right">38</td>
</tr>
<tr class="even">
<td align="left">1697</td>
<td align="left">NoS</td>
<td align="right">8.9</td>
<td align="right">8.0</td>
<td align="right">3.00</td>
<td align="right">32.00</td>
<td align="right">29.0</td>
<td align="right">195.00</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">1697</td>
<td align="left">Pro-P</td>
<td align="right">17.2</td>
<td align="right">14.5</td>
<td align="right">5.00</td>
<td align="right">54.00</td>
<td align="right">49.0</td>
<td align="right">688.00</td>
<td align="right">40</td>
</tr>
<tr class="even">
<td align="left">1700</td>
<td align="left">Anti-P</td>
<td align="right">14.9</td>
<td align="right">12.0</td>
<td align="right">4.00</td>
<td align="right">46.00</td>
<td align="right">42.0</td>
<td align="right">612.00</td>
<td align="right">41</td>
</tr>
<tr class="odd">
<td align="left">1700</td>
<td align="left">NoS</td>
<td align="right">7.3</td>
<td align="right">5.0</td>
<td align="right">3.00</td>
<td align="right">26.00</td>
<td align="right">23.0</td>
<td align="right">254.50</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">1700</td>
<td align="left">Pro-P</td>
<td align="right">14.8</td>
<td align="right">12.0</td>
<td align="right">4.00</td>
<td align="right">38.00</td>
<td align="right">34.0</td>
<td align="right">561.50</td>
<td align="right">38</td>
</tr>
</tbody>
</table>
<p>To do the analysis comparing the median tax paid for the three groups we can graph the values over time. In this case, we will first make a data set of statistics to work with.</p>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="va">yearly_tax</span> <span class="op">&lt;-</span> <span class="va">tax_comparison</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">Year</span>, <span class="va">Petition</span><span class="op">)</span> <span class="op">%&gt;%</span>
            <span class="fu">summarize</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,
                                   minimum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>,
                      maximum <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, range <span class="op">=</span> <span class="va">maximum</span> <span class="op">-</span> <span class="va">minimum</span>, 
                      sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Tax</span><span class="op">)</span>, Count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">yearly_tax</span><span class="op">)</span> <span class="op">+</span> 
        <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">median</span>, group <span class="op">=</span> <span class="va">Petition</span>, color <span class="op">=</span> <span class="va">Petition</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Tax paid by petition"</span>, y <span class="op">=</span> <span class="st">"Shillings"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span> </pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-23-1.png" width="480"></p>
<p>The analysis of annual data on the website specifically focuses on thse who were Pro- and Anti- Parris based on petition signatures. As can be seen in the previous graph, those who did not sign petititions always had a lower median tax, but the other two groups were inconsistent. To address this the site presents the ratio of the medians of the two group. A ratio of 1.0 means that the median tax for the two groups was identical. A ratio of great than 1 means that the Pro-Parris group had a higher median. A ratio of less than one means that the Anti-Parris group had a higher median.</p>
<div class="sourceCode" id="cb36"><pre class="downlit">

<span class="va">ratios</span> <span class="op">&lt;-</span> <span class="va">yearly_tax</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Petition</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pro-P"</span>, <span class="st">"Anti-P"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
                   <span class="fu">select</span><span class="op">(</span><span class="va">Year</span>, <span class="va">Petition</span>, <span class="va">median</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                   <span class="fu">pivot_wider</span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>, values_from <span class="op">=</span> <span class="va">median</span>, 
                               names_from <span class="op">=</span> <span class="va">Petition</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                    <span class="fu">mutate</span><span class="op">(</span>median_ratio <span class="op">=</span> <span class="va">`Pro-P`</span><span class="op">/</span><span class="va">`Anti-P`</span><span class="op">)</span>
<span class="va">ratios</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Year</th>
<th align="right">Anti-P</th>
<th align="right">Pro-P</th>
<th align="right">median_ratio</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1681</td>
<td align="right">51.0</td>
<td align="right">40.8</td>
<td align="right">0.8000000</td>
</tr>
<tr class="even">
<td align="left">1690</td>
<td align="right">14.0</td>
<td align="right">14.0</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="left">1694</td>
<td align="right">10.5</td>
<td align="right">9.0</td>
<td align="right">0.8571429</td>
</tr>
<tr class="even">
<td align="left">1695</td>
<td align="right">11.2</td>
<td align="right">8.0</td>
<td align="right">0.7142857</td>
</tr>
<tr class="odd">
<td align="left">1697</td>
<td align="right">13.5</td>
<td align="right">14.5</td>
<td align="right">1.0740741</td>
</tr>
<tr class="even">
<td align="left">1700</td>
<td align="right">12.0</td>
<td align="right">12.0</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb37"><pre class="downlit">
<span class="fu">ggplot</span><span class="op">(</span><span class="va">ratios</span>, 
        <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">median_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_line</span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Ratio of Pro- to Anti- Parris median tax"</span>,
             y <span class="op">=</span> <span class="st">"Ratio"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span> </pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-24-1.png" width="480"></p>
<p>The same analysis can be done but substituting mean for median.</p>
<div class="sourceCode" id="cb38"><pre class="downlit">
<span class="va">ratios</span> <span class="op">&lt;-</span> <span class="va">yearly_tax</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Petition</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pro-P"</span>, <span class="st">"Anti-P"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
                   <span class="fu">select</span><span class="op">(</span><span class="va">Year</span>, <span class="va">Petition</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                   <span class="fu">pivot_wider</span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>, values_from <span class="op">=</span> <span class="va">mean</span>, 
                               names_from <span class="op">=</span> <span class="va">Petition</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                    <span class="fu">mutate</span><span class="op">(</span>mean_ratio <span class="op">=</span> <span class="va">`Pro-P`</span><span class="op">/</span><span class="va">`Anti-P`</span><span class="op">)</span>
<span class="va">ratios</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Year</th>
<th align="right">Anti-P</th>
<th align="right">Pro-P</th>
<th align="right">mean_ratio</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1681</td>
<td align="right">62.9</td>
<td align="right">55.2</td>
<td align="right">0.8775835</td>
</tr>
<tr class="even">
<td align="left">1690</td>
<td align="right">15.8</td>
<td align="right">14.8</td>
<td align="right">0.9367089</td>
</tr>
<tr class="odd">
<td align="left">1694</td>
<td align="right">14.4</td>
<td align="right">11.3</td>
<td align="right">0.7847222</td>
</tr>
<tr class="even">
<td align="left">1695</td>
<td align="right">15.1</td>
<td align="right">10.9</td>
<td align="right">0.7218543</td>
</tr>
<tr class="odd">
<td align="left">1697</td>
<td align="right">19.0</td>
<td align="right">17.2</td>
<td align="right">0.9052632</td>
</tr>
<tr class="even">
<td align="left">1700</td>
<td align="right">14.9</td>
<td align="right">14.8</td>
<td align="right">0.9932886</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb39"><pre class="downlit">
<span class="fu">ggplot</span><span class="op">(</span><span class="va">ratios</span>, 
        <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">mean_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_line</span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Ratio of Pro- to Anti- Parris mean tax"</span>,
             y <span class="op">=</span> <span class="st">"Ratio"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span> </pre></div>
<p><img src="recreating_analyses_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>The site also looks at individual trajectories using ranks and percentiles within each year, allowing analysis of whether an individual’s financial position changed substantially over time. Individuals whose percentile changed by more than 10 are considered to have moved substantially.</p>
<p>There are many ways to do this, and the method chosen will depend on your purposes. The example below is not necessarily the best or most efficient. To do the analysis we need to obtain the rank and percentile for each of the tax amounts within the years. Finally, we need to compare those. In this example we will focus on the <a href="https://www.tulane.edu/~salem/1681-90%20Rank.html">1681-1690 comparison shown</a> while providing a framework for the others.</p>
<p>First create a wide data set and calculate ranks and cumulative proportions. This allows viewing and sorting of individuals for specific years.</p>
<div class="sourceCode" id="cb40"><pre class="downlit">
<span class="va">persisters</span> <span class="op">&lt;-</span> <span class="va">tax_comparison</span> <span class="op">%&gt;%</span> <span class="fu">pivot_wider</span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Name</span>, <span class="va">Petition</span><span class="op">)</span>,
                                             names_from <span class="op">=</span> <span class="va">Year</span>,
                                             names_prefix <span class="op">=</span> <span class="st">"X"</span>,
                                             values_from <span class="op">=</span> <span class="va">Tax</span>
                                             <span class="op">)</span> <span class="op">%&gt;%</span>
                                 <span class="fu">relocate</span><span class="op">(</span><span class="va">X1681</span>, .before <span class="op">=</span> <span class="va">X1690</span><span class="op">)</span> </pre></div>
<p>Next we want to compare our two selected years and determine the number who went up, down and stayed the same and how that relates to the petitions. This analysis is based on the empirical cumulative relative frequency.</p>
<p>To reproduce the analysis on the website we use the dplyr min_rank function (which is equivalent to rank(ties.method = “min”) in base R). This ranks all of the tax payments with gaps between the ties. So if two people are tied for the second rank, the person after them would be ranked fourth. Turn the rank into a percentile by subtracting 1 and dividing by the number of tax payers in that year.</p>
<div class="sourceCode" id="cb41"><pre class="downlit">

<span class="va">comparison</span> <span class="op">&lt;-</span> <span class="va">persisters</span> <span class="op">%&gt;%</span> 
                    <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span>, 
                                               <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                                                    rank <span class="op">=</span> <span class="va">min_rank</span>
                                                    <span class="op">)</span>
                                        <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
                   <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">X1690</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">X1681</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
                   <span class="fu">mutate</span><span class="op">(</span>
                         X1690_ptile <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">X1690_rank</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span>,
                         X1681_ptile <span class="op">=</span> <span class="fl">100</span><span class="op">*</span> <span class="op">(</span><span class="va">X1681_rank</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">94</span>,
                         compare_1681_1690 <span class="op">=</span>
                         <span class="fu">case_when</span><span class="op">(</span>
                          <span class="va">X1690_ptile</span> <span class="op">-</span><span class="va">X1681_ptile</span> <span class="op">&gt;=</span>  <span class="fl">10</span> <span class="op">~</span> <span class="st">"Up"</span>,
                          <span class="va">X1690_ptile</span> <span class="op">-</span><span class="va">X1681_ptile</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="fl">10</span> <span class="op">~</span> <span class="st">"Down"</span>,
                          <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"No Change"</span>
                        <span class="op">)</span>  
                    <span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">compare_1681_1690</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">Petition</span>, 
      dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Change"</span>, <span class="st">"Petition"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">kable</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Change in position 1681-1690"</span><span class="op">)</span></pre></div>
<table class="table">
<caption>Change in position 1681-1690</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Anti-P</th>
<th align="right">NoS</th>
<th align="right">Pro-P</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Down</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">No Change</td>
<td align="right">10</td>
<td align="right">2</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">Up</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>This has illustrated how to reproduce the analyses from the Salem Witchcraft Website. The raw data is available at the websie and at <a href="https://github.com/elinw/salem/tree/master/rawdata">the respository for this package</a>. The code used to transform the original data into the files presented here is also available at that location.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Elin Waring, Richard Latner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
